<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QR Code Manager</title>
    <link rel="icon" type="image/jpeg" href="zombatar.jpg" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- Landscape Warning Overlay -->
    <div class="landscape-warning" id="landscape-warning">
      <div class="landscape-warning-content">
        <svg
          class="landscape-warning-icon"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <rect x="4" y="2" width="16" height="20" rx="2" ry="2"></rect>
          <line x1="12" y1="18" x2="12" y2="18"></line>
        </svg>
        <p>专为竖屏设计，请使用竖屏设备，如手机</p>
        <p>或者把浏览器窗口调整为竖屏</p>
      </div>
    </div>

    <div class="app-container" id="app-container">
      <!-- Top Ribbon / Formula Bar Area -->
      <div class="excel-header">
        <div class="formula-bar-wrapper">
          <div class="name-box" id="name-box">A1</div>
          <div class="formula-icon-separator">
            <svg viewBox="0 0 24 24" class="fx-icon">
              <path
                fill="#666"
                d="M5,4H8L11,10L14,4H17L12.5,12L17,20H14L11,14L8,20H5L9.5,12L5,4Z"
              />
            </svg>
            <!-- Simple X like symbol -->
          </div>
          <!-- Actual SVG for fx is complex, using text fx for simplicity or simple path above -->
          <div class="fx-text" id="fx-btn" title="打开二维码选择器">fx</div>
          <div class="formula-divider"></div>
          <div
            class="formula-input"
            contenteditable="false"
            id="formula-input"
          ></div>
        </div>
        <img src="help.png" alt="帮助" class="header-logo" title="帮助" />
      </div>

      <!-- Spreadsheet Grid -->
      <div class="spreadsheet-container" id="spreadsheet-container">
        <!-- This will be populated by JS: Corner, Headers, Row Numbers, Cells -->
      </div>

      <!-- Footer / Sheet Tabs -->
      <div class="status-bar">
        <div class="sheet-controls">
          <button class="nav-btn" id="btn-export" title="Export Data">
            &lt;
          </button>
          <button class="nav-btn" id="btn-import" title="Import Data">
            &gt;
          </button>
          <input
            type="file"
            id="import-file"
            style="display: none"
            accept=".json"
          />
        </div>
        <div class="sheet-tabs-list" id="sheet-tabs-list">
          <!-- Generated by JS -->
        </div>
        <button class="new-sheet-btn" id="new-sheet-btn">
          <div class="plus-icon">+</div>
        </button>

        <div class="scroll-spacer"></div>
      </div>

      <!-- Page Footer -->
      <div class="page-footer">
        Made with Antigravity. See code in
        <a href="https://github.com/Lyn7Eiki/qrcode-selector" target="_blank"
          >github</a
        >.
      </div>
    </div>

    <!-- QR Selector Modal -->
    <div class="qr-modal-overlay" id="qr-modal-overlay">
      <div class="qr-modal">
        <div class="qr-modal-header">
          <h2>二维码选择器</h2>
          <span class="qr-modal-close" id="qr-modal-close">&times;</span>
        </div>
        <div class="qr-modal-body">
          <div class="qr-upper-section">
            <div class="qr-card">
              <div class="qr-zoom-btn" id="qr-zoom-btn" title="点击全屏查看">
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="11" cy="11" r="8"></circle>
                  <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                  <line x1="11" y1="8" x2="11" y2="14"></line>
                  <line x1="8" y1="11" x2="14" y2="11"></line>
                </svg>
              </div>
              <div class="qr-container" id="qr-target"></div>
              <div class="qr-card-footer">
                <div class="qr-card-title" id="qr-card-title">请选择设备</div>
                <div class="qr-card-subtitle" id="qr-card-subtitle">-</div>
              </div>
            </div>
            <div class="qr-right-menu" id="qr-sub-list"></div>
          </div>
          <div class="qr-bottom-nav" id="qr-main-nav"></div>
        </div>
      </div>
    </div>

    <!-- Fullscreen QR Overlay -->
    <div class="qr-fullscreen-overlay" id="qr-fullscreen-overlay">
      <div class="qr-fullscreen-content" onclick="event.stopPropagation()">
        <span class="qr-fullscreen-close" id="qr-fullscreen-close"
          >&times;</span
        >
        <div class="qr-fullscreen-card">
          <div
            class="qr-fullscreen-qr-container"
            id="qr-fullscreen-target"
          ></div>
          <div class="qr-fullscreen-footer">
            <div class="qr-fullscreen-title" id="qr-fullscreen-title">
              设备名称
            </div>
            <div class="qr-fullscreen-subtitle" id="qr-fullscreen-subtitle">
              编号
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="qrcode.js"></script>
    <script src="script.js"></script>
  </body>
</html>
